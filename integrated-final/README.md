# 仙女下凡來點名 - LINE AI 助理完整整合版

[![部署狀態](https://github.com/liboyin9087-jpg/autoline/actions/workflows/deploy-cloudrun.yml/badge.svg)](https://github.com/liboyin9087-jpg/autoline/actions/workflows/deploy-cloudrun.yml)

> 💡 **想要立即部署？** 查看 [快速部署指南](QUICK_DEPLOY.md)

這是一個功能完整的 LINE 風格 AI 助理應用程式，整合了三大娛樂性功能以及所有核心管理功能，為用戶提供最佳的互動體驗。

## 核心功能特色

本專案整合了以下重要功能模組，為用戶打造一個功能強大且有趣的 AI 互動平台。首先在基礎互動功能方面，系統提供了五種不同個性的 AI 角色供用戶選擇，包括智慧仙姑、桃花仙子、閃電娘娘、雲夢仙子以及天機星君，每個角色都有獨特的對話風格和專長領域。使用者可以上傳圖片、文件等多種格式的檔案，系統會自動處理並整合到對話中。

在娛樂性功能方面，神籤系統提供了三種抽籤方式，包括傳統的搖籤筒、擲筊以及現代化的轉盤抽籤，為用戶帶來趣味性的運勢預測體驗。仙女群聊功能讓五位不同個性的仙女同時回應同一個問題，用戶可以看到不同觀點的精彩對話。彩蛋關鍵字系統則在用戶輸入特定詞彙時觸發特殊動畫效果和驚喜回應，增加互動的樂趣。

進階管理功能包含完整的 Token 使用統計，讓用戶能夠清楚掌握 API 使用量和成本控制。群組成員管理介面採用仿 LINE 設計，提供直觀的成員查看和管理功能。智慧化的輸出 Token 調整機制會根據不同的 AI 角色自動優化回應長度，既能確保回答品質又能有效控制成本。

## 技術架構說明

前端技術棧採用 React 18 搭配 TypeScript 開發，使用 Vite 作為建置工具以獲得最佳的開發體驗。UI 框架選用 Tailwind CSS 進行樣式設計，並整合 Lucide React 提供精美的圖示系統。Markdown 渲染功能透過 react-markdown 實現，支援 GitHub Flavored Markdown 語法。

後端架構使用 Express.js 建立 RESTful API 服務，採用 ES Modules 格式確保與現代 JavaScript 生態系統的相容性。CORS 配置完整，支援跨域請求處理。系統整合 Google Gemini 2.0 Flash 模型提供 AI 對話能力，並實作完整的錯誤處理和日誌記錄機制。

## 環境設定與部署

在開始使用前，您需要先取得 Google Gemini API 金鑰。請前往 Google AI Studio 網站申請免費的 API 金鑰。取得金鑰後，在專案根目錄建立 .env 檔案，並填入您的 API 金鑰。範例配置如下：

```
GOOGLE_API_KEY=your_actual_api_key_here
PORT=8080
NODE_ENV=development
```

完成環境變數設定後，執行 npm install 指令安裝所有必要的依賴套件。開發環境下建議開啟兩個終端視窗，一個執行 npm run dev:server 啟動後端伺服器，另一個執行 npm run dev 啟動前端開發伺服器。前端預設在 port 5173 運行，後端則在 port 8080。

生產環境部署時，請先執行 npm run build 建置前端靜態檔案，建置完成後直接執行 node server.js 即可啟動生產伺服器。伺服器會同時提供 API 服務和靜態檔案託管。

## GitHub 部署建議

將專案推送到 GitHub 時，請確保 .env 檔案已被加入 .gitignore 清單中，避免將敏感的 API 金鑰上傳到公開儲存庫。建議在 GitHub 儲存庫的 Settings > Secrets and variables > Actions 中設定環境變數，以便在 CI/CD 流程中安全地使用。

如需部署到 Google Cloud Platform，可以參考專案中的 cloudbuild.yaml 和 Dockerfile 配置檔案。這些檔案已經針對 Cloud Run 或 App Engine 部署進行最佳化。部署前請確保在 GCP 專案中設定好環境變數，並開啟必要的 API 服務。

## 功能使用指南

系統啟動後，用戶首先會看到角色選擇介面。選擇適合的 AI 角色後即可開始對話。介面下方提供了多個快速操作按鈕，點擊「天宮籤」可以開啟神籤系統，體驗不同的抽籤方式。如需使用仙女群聊功能，可以在設定選單中開啟此功能，然後輸入問題時會看到群聊選項。

麥克風功能讓用戶可以直接錄製語音訊息，系統會自動轉換並處理。Emoji 選擇器提供常用的表情符號快速插入。篩選器功能則允許用戶指定希望獲得的回應類型，例如純文字、圖片分析、程式碼或數據分析等。

群組成員查看功能模擬了 LINE 的介面設計，點擊左上角的群組圖示即可查看所有 AI 角色成員。Token 使用統計可在設定選單中查看，系統會記錄每日的使用量並提供圖表化的統計資訊。

## 故障排除建議

如果遇到後端無法連線的問題，請首先檢查 .env 檔案是否存在且 API 金鑰配置正確。確認 port 8080 沒有被其他程序佔用，可以使用 lsof -i :8080 指令檢查。查看終端中的伺服器日誌輸出，通常會有明確的錯誤訊息指示問題所在。

前端顯示異常時，請檢查瀏覽器的開發者工具控制台是否有錯誤訊息。確認前端開發伺服器已正確啟動在 port 5173，並且能夠透過 Vite 的代理設定連接到後端 API。如果看到 CORS 相關錯誤，請檢查 server.js 中的 CORS 配置是否正確。

API 配額用盡的情況下，系統會顯示明確的錯誤提示。您可以前往 Google AI Studio 查看當前的配額使用狀況，或考慮升級到付費方案以獲得更高的使用額度。建議透過 Token 統計功能定期檢視使用量，以便更好地控制成本。

## 技術支援與貢獻

本專案歡迎社群貢獻。如果您發現任何問題或有改進建議，歡迎在 GitHub 上提交 Issue 或 Pull Request。在提交 PR 前，請確保您的程式碼遵循專案的編碼風格，並且所有功能都經過測試。

專案採用 MIT 授權條款，您可以自由使用、修改和分發本專案。如果您基於本專案開發了新功能或改進，我們非常期待您能回饋給社群，讓更多人受益。

## 版本資訊

當前版本：v2.0.0 完整整合版
發布日期：2024年12月

主要更新內容包括整合三大娛樂性功能模組、優化 Token 使用管理機制、改進用戶介面設計以及強化錯誤處理和日誌記錄系統。這個版本代表了專案功能的完整整合，為用戶提供了最佳的使用體驗。
